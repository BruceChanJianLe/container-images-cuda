---
# Architectures that CUDA Docker Runtime Supports
arch:
  - x86_64
  - ppc64le

docker_repos:
  docker.io:
    # Will only use this repo if the REGISTRY_TOKEN environment variable is set
    only_if: REGISTRY_TOKEN
    pass: REGISTRY_TOKEN
    user: REGISTRY_USER
    registry: docker.io
  nvcr.io:
    only_if: NVCR_TOKEN
    pass: NVCR_TOKEN
    user: $oauthtoken
    registry: nvcr.io/nvidian
  gitlab-internal:
    only_if: NV_CI_INTERNAL
    user: "gitlab-ci-token"
    pass: CI_JOB_TOKEN
    registry: gitlab-master.nvidia.com:5005

.centos-cudnn7: &centos_cudnn7_definition
  version: 7.6.0.64
  sha256sum: e956c6f9222fcb867a10449cfc76dee5cfd7c7531021d95fe9586d7e043b57d7

centos6:
  <<: *centos_cudnn7_definition
  arch:
    ppc64le: false
  cuda:
    repo_url: "http://developer.download.nvidia.com/compute/cuda/repos/rhel6/x86_64"
    v10.0:
      build_version: 130
      cuda_requires: "brand=tesla,driver>=384,driver<385 brand=tesla,driver>=410,driver<411"
      cudnn7:
        version: "7.6.0.64"
        sha256sum: "c4e1ee4168f4cadabaa989487a47bed09f34d34e35398b6084a2699d11bd2560"
    v10.1:
      build_version: 168
      cuda_requires: "brand=tesla,driver>=384,driver<385 brand=tesla,driver>=396,driver<397 brand=tesla,driver>=410,driver<411"
      cudnn7:
        version: "7.6.0.64"
        sha256sum: "e956c6f9222fcb867a10449cfc76dee5cfd7c7531021d95fe9586d7e043b57d7"

redhat7: &redhat7_definition
  <<: *centos_cudnn7_definition
  template_path: redhat
  cuda:
    repo_url: "http://developer.download.nvidia.com/compute/cuda/repos/rhel6/x86_64"
    v10.0:
      build_version: 130
      cuda_requires: "brand=tesla,driver>=384,driver<385 brand=tesla,driver>=410,driver<411"
      cudnn7:
        version: "7.6.0.64"
        sha256sum: "c4e1ee4168f4cadabaa989487a47bed09f34d34e35398b6084a2699d11bd2560"
    v10.1:
      build_version: 168
      cuda_requires: "brand=tesla,driver>=384,driver<385 brand=tesla,driver>=396,driver<397 brand=tesla,driver>=410,driver<411"
      cudnn7:
        version: "7.6.0.64"
        sha256sum: "e956c6f9222fcb867a10449cfc76dee5cfd7c7531021d95fe9586d7e043b57d7"

ubi7:
  <<: *redhat7_definition
  base_image: registry.access.redhat.com/ubi7/ubi:latest
  exclude_repos:
    - docker.io

centos7:
  <<: *redhat7_definition
  base_image: centos:7
